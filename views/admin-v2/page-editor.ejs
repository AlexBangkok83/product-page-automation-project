<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Page - Home</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- TinyMCE -->
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    
    <style>
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="w-64 bg-white border-r border-gray-200 flex flex-col">
            <!-- Logo/Brand -->
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex items-center">
                    <i data-lucide="store" class="w-8 h-8 text-blue-600"></i>
                    <span class="ml-2 text-lg font-semibold text-gray-900">MultiStore</span>
                </div>
            </div>
            
            <!-- Navigation -->
            <nav class="flex-1 px-4 py-6 space-y-1">
                <!-- Dashboard -->
                <a href="/admin-v2" class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-lg">
                    <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3"></i>
                    Dashboard
                </a>
                
                <!-- Companies -->
                <div class="pt-4">
                    <div class="flex items-center px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Companies
                    </div>
                    <div class="mt-2 space-y-1 ml-3">
                        <a href="/admin-v2" class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-lg">
                            <i data-lucide="building-2" class="w-4 h-4 mr-3"></i>
                            Nextsite
                        </a>
                    </div>
                </div>
                
                <!-- Nextsite expanded -->
                <div class="ml-6 space-y-1">
                    <a href="/admin-v2/company/settings" class="flex items-center px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg">
                        <i data-lucide="settings" class="w-4 h-4 mr-3"></i>
                        Company Settings
                    </a>
                    <a href="/admin-v2/company/design" class="flex items-center px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg">
                        <i data-lucide="palette" class="w-4 h-4 mr-3"></i>
                        Design Library
                    </a>
                    <div class="pt-2">
                        <div class="flex items-center px-3 py-1 text-xs font-medium text-gray-500">
                            Shopify Connections
                        </div>
                        <div class="ml-3 mt-1 space-y-1">
                            <a href="/admin-v2/shopify/ecominter" class="flex items-center px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg">
                                <i data-lucide="shopping-bag" class="w-4 h-4 mr-3"></i>
                                ecominter.myshopify.com
                            </a>
                            <div class="ml-6 space-y-1">
                                <a href="/admin-v2/store/882eacac-d9fa-411c-a9f8-7415c26240b9" class="flex items-center px-3 py-2 text-sm font-medium text-blue-700 bg-blue-50 rounded-lg">
                                    <i data-lucide="globe" class="w-3 h-3 mr-3"></i>
                                    clipia.de
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- Bottom section -->
            <div class="px-4 py-4 border-t border-gray-200">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center">
                        <i data-lucide="user" class="w-4 h-4 text-gray-600"></i>
                    </div>
                    <div class="ml-3">
                        <div class="text-sm font-medium text-gray-900">Admin</div>
                        <div class="text-xs text-gray-500">admin@company.com</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-white border-b border-gray-200 px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <a href="/admin-v2/store/882eacac-d9fa-411c-a9f8-7415c26240b9" class="text-gray-500 hover:text-gray-700">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i>
                        </a>
                        <div>
                            <h1 class="text-2xl font-semibold text-gray-900">Edit Page: Home</h1>
                            <p class="text-sm text-gray-500 mt-1">clipia.de</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <a href="https://clipia.de" target="_blank" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50">
                            <i data-lucide="external-link" class="w-4 h-4 mr-2"></i>
                            Preview
                        </a>
                        <button id="save-deploy-page" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700">
                            <i data-lucide="save" class="w-4 h-4 mr-2"></i>
                            Save & Deploy
                        </button>
                    </div>
                </div>
            </header>
            
            <!-- Main Content Area -->
            <main class="flex-1 overflow-hidden">
                <div class="h-full flex">
                    <!-- Content Editor -->
                    <div class="flex-1 flex flex-col">
                        <!-- Page Settings Bar -->
                        <div class="bg-gray-50 border-b border-gray-200 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 mb-1">Page Title</label>
                                        <input type="text" value="Welcome to Clipia Deuchland" 
                                               class="w-64 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 mb-1">URL Slug</label>
                                        <input type="text" value="/" disabled
                                               class="w-32 px-3 py-1.5 border border-gray-300 rounded-lg text-sm bg-gray-100 text-gray-500">
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <i data-lucide="check-circle" class="w-3 h-3 mr-1"></i>
                                        Published
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Editor Area -->
                        <div class="flex-1 p-6">
                            <div class="h-full">
                                <textarea id="content-editor" name="content" class="w-full h-full">
<h2>Welcome to Clipia Deuchland</h2>
<p>Discover amazing products and quality service at Clipia Deuchland.</p>

<h3>Our Featured Products</h3>
<p>Browse our carefully selected collection of premium products.</p>

<div style="display: flex; gap: 20px; margin: 30px 0;">
    <div style="flex: 1; text-align: center;">
        <h4>Elegante Solbriller for Alle</h4>
        <p>Premium sunglasses for every occasion.</p>
        <p><strong>€29.95</strong></p>
    </div>
    <div style="flex: 1; text-align: center;">
        <h4>Klipia - Sätt upp håret</h4>
        <p>The perfect hair accessory for any style.</p>
        <p><strong>€19.95</strong></p>
    </div>
</div>

<h3>Why Choose Clipia Deuchland?</h3>
<ul>
    <li>Premium quality products</li>
    <li>Fast and reliable shipping</li>
    <li>Excellent customer service</li>
    <li>Secure payment options</li>
</ul>

<p>Ready to shop? <a href="/products.html">Browse our full collection</a> today!</p>
                                </textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sidebar Panel -->
                    <div class="w-80 bg-white border-l border-gray-200 flex flex-col">
                        <!-- Panel Header -->
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-medium text-gray-900">Page Settings</h3>
                        </div>
                        
                        <!-- Panel Content -->
                        <div class="flex-1 overflow-y-auto p-6 space-y-6">
                            <!-- SEO Settings -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-900 mb-3">SEO Settings</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Meta Title</label>
                                        <input type="text" value="Welcome to Clipia Deuchland" 
                                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <p class="text-xs text-gray-500 mt-1">60 characters recommended</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Meta Description</label>
                                        <textarea rows="3" 
                                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                  placeholder="Discover amazing products and quality service at Clipia Deuchland.">Discover amazing products and quality service at Clipia Deuchland.</textarea>
                                        <p class="text-xs text-gray-500 mt-1">160 characters recommended</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Page Settings -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-900 mb-3">Page Settings</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Page Type</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="home" selected>Home Page</option>
                                            <option value="page">Regular Page</option>
                                            <option value="product">Product Page</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Template</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="default" selected>Default Template</option>
                                            <option value="landing">Landing Page</option>
                                            <option value="minimal">Minimal Template</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" id="show-in-nav" checked
                                               class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                        <label for="show-in-nav" class="ml-2 text-sm text-gray-700">
                                            Show in navigation
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Quick Actions -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-900 mb-3">Quick Actions</h4>
                                <div class="space-y-2">
                                    <button class="w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50">
                                        <i data-lucide="copy" class="w-4 h-4 mr-2"></i>
                                        Duplicate Page
                                    </button>
                                    <button class="w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50">
                                        <i data-lucide="eye" class="w-4 h-4 mr-2"></i>
                                        Preview Changes
                                    </button>
                                    <button class="w-full inline-flex items-center justify-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50">
                                        <i data-lucide="trash-2" class="w-4 h-4 mr-2"></i>
                                        Delete Page
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Page History -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-900 mb-3">Recent Changes</h4>
                                <div class="space-y-3">
                                    <div class="text-xs text-gray-500">
                                        <div class="font-medium text-gray-900">Last saved</div>
                                        <div>2 minutes ago by Admin</div>
                                    </div>
                                    <div class="text-xs text-gray-500">
                                        <div class="font-medium text-gray-900">Last deployed</div>
                                        <div>5 minutes ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        lucide.createIcons();
        
        // Initialize TinyMCE
        tinymce.init({
            selector: '#content-editor',
            height: '100%',
            menubar: false,
            plugins: 'lists link image code table',
            toolbar: 'undo redo | formatselect | bold italic | bullist numlist | link image | code',
            content_style: 'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; font-size: 14px; line-height: 1.6; }',
            branding: false,
            resize: false
        });
        
        // Handle Save & Deploy button
        document.getElementById('save-deploy-page').addEventListener('click', async function() {
            const button = this;
            const originalText = button.innerHTML;
            
            // Disable button and show loading
            button.disabled = true;
            button.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Saving & Deploying...';
            
            try {
                // Get content from TinyMCE
                const content = tinymce.get('content-editor').getContent();
                const title = document.querySelector('input[value="Welcome to Clipia Deuchland"]').value;
                const metaTitle = document.querySelector('input[value="Welcome to Clipia Deuchland"]').value;
                const metaDescription = document.querySelector('textarea[placeholder*="Discover amazing products"]').value;
                
                const formData = {
                    title: title,
                    content: content,
                    meta_title: metaTitle,
                    meta_description: metaDescription,
                    page_type: 'home' // This would come from the page context
                };
                
                // Extract store ID from URL (assuming URL format /admin-v2/store/:storeId/page/:pageId/edit)
                const urlParts = window.location.pathname.split('/');
                const storeId = urlParts[3]; // Assuming /admin-v2/store/STOREID/page/PAGEID/edit
                const pageId = urlParts[5];
                
                const response = await fetch(`/admin-v2/store/${storeId}/page/${pageId}/edit`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showNotification('Page saved and deployed successfully!', 'success');
                } else {
                    showNotification('Failed to save page: ' + result.message, 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error saving page', 'error');
            } finally {
                // Re-enable button
                button.disabled = false;
                button.innerHTML = originalText;
                lucide.createIcons();
            }
        });
        
        // Utility function to show notifications
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-4 py-2 rounded-lg text-white z-50 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>